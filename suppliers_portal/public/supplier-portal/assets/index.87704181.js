var h=(e,o,n)=>new Promise((s,r)=>{var t=p=>{try{a(n.next(p))}catch(g){r(g)}},c=p=>{try{a(n.throw(p))}catch(g){r(g)}},a=p=>p.done?s(p.value):Promise.resolve(p.value).then(t,c);a((n=n.apply(e,o)).next())});import{c as m,r as L,a as I,b as k,d as S,_ as y,e as E,f as P,g as b,o as C,h as R,s as T,i as w,j as $,C as U,I as j,k as O}from"./vendor.99304cc5.js";const A=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerpolicy&&(t.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?t.credentials="include":r.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(r){if(r.ep)return;r.ep=!0;const t=n(r);fetch(r.href,t)}};A();const x="modulepreload",v={},N="/assets/suppliers_portal/supplier-portal/",d=function(o,n){return!n||n.length===0?o():Promise.all(n.map(s=>{if(s=`${N}${s}`,s in v)return;v[s]=!0;const r=s.endsWith(".css"),t=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${t}`))return;const c=document.createElement("link");if(c.rel=r?"stylesheet":x,r||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),r)return new Promise((a,p)=>{c.addEventListener("load",a),c.addEventListener("error",p)})})).then(()=>o())},_=m({url:"frappe.auth.get_logged_user",cache:"User",onError(e){e&&e.exc_type==="AuthenticationError"&&u.push({name:"LoginPage"})}});function f(){let o=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return o==="Guest"&&(o=null),o}function V(){return new URLSearchParams(document.cookie.split("; ").join("&")).get("supplier_id")}function D(){return new URLSearchParams(document.cookie.split("; ").join("&")).get("supplier_name")}const i=L({supplier_login:m({url:"suppliers_portal.suppliers_portal.api.validate_supplier_id",makeParams({supplier_id:e}){return{supplier_id:e}},onSuccess(e){e&&e.status==="success"&&(_.reload(),i.user=f(),document.cookie=`supplier_id=${e.supplier_id}`,document.cookie=`supplier_name=${e.supplier_name}`,i.supplier_id=e.supplier_id,i.supplier_name=e.supplier_name,i.login.reset(),u.replace({name:"SupplierInvoiceList"}))},onError(e){console.error("Login failed",e)}}),login:m({url:"login",makeParams({email:e,password:o}){return{usr:e,pwd:o}},onSuccess(e){e&&(_.reload(),i.user=f(),document.cookie=`supplier_id=${i.supplier_id}; expires=Thu, 01 Jan 1970 00:00:00 UTC'`,document.cookie=`supplier_id=${i.supplier_name}; expires=Thu, 01 Jan 1970 00:00:00 UTC'`,i.supplier_id="",i.supplier_name="",i.login.reset(),u.replace({name:"SupplierInvoiceList"}))},onError(e){console.error("Login failed",e)}}),logout:m({url:"logout",onSuccess(){document.cookie=`supplier_id=${i.supplier_id}; expires=Thu, 01 Jan 1970 00:00:00 UTC'`,document.cookie=`supplier_id=${i.supplier_name}; expires=Thu, 01 Jan 1970 00:00:00 UTC'`,i.supplier_id="",i.supplier_name="",_.reset(),i.user=f(),u.replace({name:"Login"})}}),user:f(),supplier_id:V(),supplier_name:D(),isLoggedIn:I(()=>!!i.user)}),J=[{name:"Login",path:"/login",component:()=>d(()=>import("./Login.14c1625b.js"),["assets/Login.14c1625b.js","assets/vendor.99304cc5.js","assets/vendor.52e2d7c1.css"])},{name:"SupplierInvoiceList",path:"/",component:()=>d(()=>import("./SupplierInvoiceList.bd20c4e8.js"),["assets/SupplierInvoiceList.bd20c4e8.js","assets/SupplierInvoiceList.e8de1e21.css","assets/vendor.99304cc5.js","assets/vendor.52e2d7c1.css"])},{name:"SupplierInvoice",path:"/invoices/:supplierInvoiceNumber",component:()=>d(()=>import("./SupplierInvoice.77908b92.js"),["assets/SupplierInvoice.77908b92.js","assets/SupplierInvoice.9dfb3ca8.css","assets/vendor.99304cc5.js","assets/vendor.52e2d7c1.css"]),props:!0},{name:"SupplierInvoiceCreate",path:"/invoices/new",component:()=>d(()=>import("./NewInvoice.632d4fad.js"),["assets/NewInvoice.632d4fad.js","assets/NewInvoice.67c196f0.css","assets/vendor.99304cc5.js","assets/vendor.52e2d7c1.css"])}];let u=k({history:S("/supplier-portal"),routes:J});u.beforeEach((e,o,n)=>h(void 0,null,function*(){let s=i.isLoggedIn;try{yield _.promise}catch(r){s=!1}console.log("isLoggedIn",s),console.log("to",e),console.log("from",o),e.name==="Login"&&s?n({name:"SupplierInvoiceList"}):e.name!=="Login"&&!s?n({name:"Login"}):n()}));const q={};function B(e,o){const n=b("router-view");return C(),E("div",null,[P(n)])}var F=y(q,[["render",B]]);let l=R(F);T("resourceFetcher",O);l.use(u);l.use(w);l.component("Button",$);l.component("Card",U);l.component("Input",j);l.mount("#app");export{f as a,V as b,D as c,u as r,i as s};
